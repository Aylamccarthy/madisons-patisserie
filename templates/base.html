{% load static %}

<!doctype html>
<html lang="en">
  <head>

    {% block meta %}
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="apple-touch-icon" sizes="180x180" href="{% static 'favicon/apple-touch-icon.png'%}">
        <link rel="icon" type="image/png" sizes="32x32" href="{% static 'favicon/favicon-32x32.png'%}">
        <link rel="icon" type="image/png" sizes="16x16" href="{% static 'favicon/favicon-16x16.png'%}">
        <meta name="description" content="Madison's Patisserie is an online bakeshop offering a wide range of 
          baked products,from cakes to pies and pastries with delivery service in Cork.">
        <meta name="keywords" content="Cakes Cork, cake delivery in cork, cork bakeshop,
          wedding cakes, custom-made cakes, occasion cakes, birthday cakes, pies, doughnuts, christening cake, 
          drip cakes, chocolate cakes, elegant cakes, scrumptious cakes, shop cakes online">
    {% endblock %}

    {% block extra_meta %}
    {% endblock %}

    {% block corecss %}
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Alice&family=Josefin+Sans&family=Yesteryear&display=swap" rel="stylesheet">
        <link rel="icon" href="{% static 'favicon' %}favicon.ico" type="image/x-icon">
        <link href="//cdn-images.mailchimp.com/embedcode/classic-061523.css" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="{% static 'css/base.css' %}">
    {% endblock %}

    {% block extra_css %}
    {% endblock %}

    <title>Madison's Patisserie{% block extra_title %}{% endblock %}</title>
  </head>
  <body>
    <!-- HEADER -->
    <header>
      <div class="col-12 col-md-6 mx-md-auto mb-md-2 mb-lg-0 col-lg-4 col-xl-3 pt-2 pt-lg-0">
        <a class="logo d-flex d-lg-none justify-content-center justify-content-lg-start align-items-end mb-2 mb-md-0" href="{% url 'home' %}">
          <img class="col-3 " src="{{ MEDIA_URL }}logo.png" alt="logo image">
          <h2>Madison's Patisserie</h2>  
        </a>
      </div>
      <div class="add-container bg-light d-lg-none mb-lg-2 ">
        <div class="add container-fluid text-center"><p class="mx-auto">Free delivery on orders over €50</p></div>
        <div class="add container-fluid text-center"><p class="mx-auto">Register and get a <span class="bg-skyblue">20% discount</span> voucher for your orders</p></div> 
      </div>
      <!-- Navigation links -->
      <nav class="navbar navbar-expand-lg navbar-light">
        <button id="navbarTogglerButton" class="navbar-toggler bg-transparent" type="button" data-toggle="collapse" data-target="#navbarToggler" aria-controls="navbarToggler" aria-expanded="false" aria-label="Toggle navigation">
          <i class="fas fa-bars text-white"></i>
        </button>
        <div class="collapse navbar-collapse" id="navbarToggler">
          <div class="container-fluid p-side">
            <ul class="categories d-block d-lg-flex col-6">
              <li class="nav-item mb-2 mb-lg-0 mr-3 mt-2 mt-lg-0">
                <a href="{% url 'home' %}" id="navitem-home">Home</a>
              </li>
              <li class="nav-item mr-3 mt-2 mt-lg-0">
                <a href="{% url 'products' %}" id="navitem-products">All products</a>
              </li>
              <li class="nav-item mr-3 mt-2 mt-lg-0">
                <div class="dropdown">
                  <a href="" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">Cakes</a>
                  <div class="dropdown-menu dropdown-menu-lg-start">
                      <a class="dropdown-item" href="{% url 'products' %}?category=buttecakesrcream_cakes">Buttercream Cakes</a>
                      <a class="dropdown-item" href="{% url 'products' %}?category=drip_">Drip Cakes</a>
                      <a class="dropdown-item" href="{% url 'products' %}?category=chocolate_cakes">Chocolate Cakes</a>
                      <a class="dropdown-item" href="{% url 'products' %}?category=occassion_cakes">Occassion Cakes</a>
                  </div>
                </div>
              </li>
              <li class="nav-item mr-3 mt-2 mt-lg-0">
                <div class="dropdown">
                  <a class="dropdown-toggle" href="{% url 'products' %}?category=everyday_essentials" data-toggle="dropdown" aria-expanded="false" >
                    Everyday Essentials
                  </a>
                  <div class="dropdown-menu dropdown-menu-lg-start">
                      <a class="dropdown-item" href="{% url 'products' %}?category=desserts">Desserts</a>
                      <a class="dropdown-item" href="{% url 'products' %}?category=sweet_treats">Sweet Treats</a>
                  </div>
                </div>
              </li>
              <div class="d-none d-lg-block col-lg-3 p-0">
                {% include 'includes/search-box.html' %}
              </div>
            </ul>
          </div>
          <hr class="d-lg-none">
          <div class="container-fluid add-container bg-light d-none d-lg-block mb-lg-2 p-lg-0">
            <div class="add container-fluid"><p class="mx-auto">Free delivery on orders over {{ free_delivery_threshold }}€</p></div>
            <div class="add container-fluid text-center"><p class="mx-auto">Register and get a <span class="bg-skyblue">20% discount</span> voucher for your orders</p></div>  
          </div>
          <div class="container-fluid d-block d-lg-flex mb-lg-1">
            <div class="col-12 col-md-6 col-lg-4 col-xl-3">
              <a class="logo d-none d-lg-flex justify-content-center justify-content-md-start align-items-end mb-2 mb-md-0" href="{% url 'home' %}">
                <img class="col-3 " src="{{ MEDIA_URL }}logo.png" alt="logo image">
                <h2>Madison's Patisserie</h2>  
              </a>
            </div>
            {% if user.is_authenticated %}
              {% if user.is_staff %}
                <div class="col-12 col-md-3 col-lg-2 col-xl-1">
                  <ul class="d-block d-lg-flex justify-content-end navigation">
                    <li class="nav-item ml-lg-4  mt-2 mt-lg-0" id="adminManageNav">
                      <div class="dropdown">
                        <a title="Admin Manage" href="#"  data-toggle="dropdown" aria-expanded="false" >
                          <span class="dropdown-toggle d-lg-none">Admin manage</span>
                          <i class="fas fa-database d-none d-lg-block"></i>
                        </a>
                        <div class="dropdown-menu dropdown-menu-lg-start">
                          <hr class="dropdown-divider">
                          <a class="dropdown-item" href="#">Orders</a>   
                          <a class="dropdown-item" data-toggle="modal" data-target="#addProductModal">Add a new product</a>
                          <hr class="dropdown-divider d-none d-lg-block">
                          <button class="dropdown-btn dropdown-item d-none d-lg-block" data-toggle="modal" data-target="#logoutModal">Logout</button>
                        </div>
                      </div>
                    </li>
                    <li class="nav-item ml-lg-4 mt-2 mt-lg-0" id="chatNav">
                      <a href="" title="Customer Service">
                        <span class="d-lg-none">Customer service</span>
                        <i class="fas fa-comments d-none d-lg-block"></i>
                      </a>
                    </li>
                    <li class="nav-item mb-2 mb-lg-0 ml-lg-4 mt-2 d-lg-none">
                      <a data-toggle="modal" data-target="#logoutModal">
                        <span>Logout</span>
                      </a>
                    </li>
                  </ul>
                </div>
              {% else %}
                <div class="col-12 col-md-6 col-lg-3 col-xl-2">
                  <ul class="d-block d-lg-flex justify-content-end navigation">
                    <li class="nav-item  ml-lg-4  mt-2 mt-lg-0" id="userNav">
                      <div class="dropdown">
                        <a class="d-none d-lg-block" title="Account" href="#"  data-toggle="dropdown" aria-expanded="false" >
                          <i class="fas fa-user-circle"></i>
                        </a>
                        <a class="d-lg-none" href="{% url 'profile' %}">
                          <span>My profile</span>
                        </a>
                        <div class="dropdown-menu dropdown-menu-lg-start">
                          <a class="dropdown-item" href="{% url 'profile' %}">My profile</a>
                          <hr class="dropdown-divider  d-none d-lg-block">
                          <button class="dropdown-item dropdown-btn" data-toggle="modal" data-target="#logoutModal">Logout</button>
                        </div>
                      </div>
                    </li>
                    <li class="nav-item ml-lg-4 mt-2 mt-lg-0 position-relative" id="wishlistNav">
                      <a href="{% url 'wishlist' %}" title="Wishlist">
                        <span class="d-lg-none">Wishlist</span>
                        <i class="fas fa-heart d-none d-lg-block"></i>
                      </a>
                      {% if wishlist_user_count %}
                      {% if wishlist_user_count > 99 %}
                          <div class="notification d-none d-lg-block m-0 position-absolute text-white"></div>
                        {% else %}
                        <div class="notification notification-small d-none d-lg-block m-0 position-absolute text-white">
                          {{wishlist_user_count}}
                        </div>
                        {% endif %}
                      {% endif %}
                    </li>
                    <li class="nav-item ml-lg-4 mt-2 mt-lg-0 position-relative" id="bagNav">
                      <a href="{% url 'bag' %}" title="Shopping Bag">
                        <span class="d-lg-none">Shopping Bag</span>
                        <i class="fas fa-shopping-bag d-none d-lg-block"></i>
                      </a>
                      {% if product_count %}
                      {% if product_count > 99 %}
                          <div class="notification d-none d-lg-block m-0 position-absolute text-white"></div>
                        {% else %}
                        <div class="notification notification-small d-none d-lg-block m-0 position-absolute text-white">
                          {{product_count}}
                        </div>
                        {% endif %}
                      {% endif %}
                    </li>
                      {% if wishlist_user_count %}
                      <div class="notification d-none d-lg-block m-0 position-absolute text-white">
                        {{wishlist_user_count}}
                      </div>
                      {% endif %}
                    </li>
                    <li class="nav-item  ml-lg-4 mt-2 mt-lg-0" id="chatNav">	
                      <a href="" title="Customer Service">	
                        <span class="d-lg-none">Customer Service</span>	
                        <i class="fas fa-comments d-none d-lg-block"></i>	
                      </a>
                    </li>
                    <li class="nav-item mx-auto mb-2 mb-lg-0 mt-2 d-lg-none">
                      <a href="{% url 'account_logout' %}" data-bs-toggle="modal" data-bs-target="#logoutModal">	
                        <span>Logout</span>	
                      </a>
                    </li>
                  </ul>
                </div>
              {% endif %}
            {% else %}
              <div class="col-12 col-md-6 col-lg-3 col-xl-2">
                <ul class="d-block d-lg-flex justify-content-end navigation">
                  <li class="nav-item ml-lg-4  mt-2 d-lg-none">	
                    <a href="{% url 'account_login' %}" >	
                      <span>Login</span>	
                    </a>	
                  </li>	
                  <li class="nav-item ml-lg-4 mt-2 d-lg-none">	
                    <a href="{% url 'account_signup' %}" >	
                      <span>Register</span>	
                    </a>	
                  </li>	
                  <li class="nav-item ml-lg-4 mt-2 mt-lg-0 d-none d-lg-block" id="userNav">
                    <div class="dropdown">
                      <a title="Account" href="#"  data-toggle="dropdown" aria-expanded="false" >
                        <i class="fas fa-user-circle"></i>
                      </a>
                      <div class="dropdown-menu dropdown-menu-lg-start">
                          <hr class="dropdown-divider">
                          <a class="dropdown-item" href="{% url 'account_login' %}" >Login</a>
                          <a class="dropdown-item"  href="{% url 'account_signup' %}">Register</a>
                      </div>
                    </div>
                  </li>
                  <li class="nav-item ml-lg-4 mt-2 mt-lg-0" id="wishlistNav">	
                    <a href="{% url 'wishlist' %}" title="Wishlist">	
                      <span class="d-lg-none">Wishlist</span>	
                      <i class="fas fa-heart d-none d-lg-block"></i>	
                    </a>	
                  </li>	
                  <li class="nav-item ml-lg-4 mt-2 mt-lg-0" id="bagNav">	
                    <a href="{% url 'bag' %}" title="Shopping Bag">
                      <span class="d-lg-none">Shopping Bag</span>	
                      <i class="fas fa-shopping-bag d-none d-lg-block"></i>	
                    </a>	
                    {% if product_count %}
                      <div class="notification d-none d-lg-block m-0 position-absolute text-white">
                      {% if product_count > 99 %}
                        <div class="notification d-none d-lg-block m-0 position-absolute text-white"></div>
                      {% else %}
                      <div class="notification notification-small d-none d-lg-block m-0 position-absolute text-white">
                        {{product_count}}
                      </div>
                      {% endif %}
                    {% endif %}
                  </li>	
                  <li class="nav-item mb-2 mb-lg-0 ml-lg-4 mt-2 mt-lg-0" id="chatNav">	
                    <a href="" title="Customer Service">	
                      <span class="d-lg-none">Customer Service</span>	
                      <i class="fas fa-comments d-none d-lg-block"></i>	
                    </a>
                  </li>
                </ul>
              </div>
            {% endif %}
          </div>
        </div>
        <div class="d-none d-md-block d-lg-none col-md-6 search-bar">
          {% include 'includes/search-box.html' %}
        </div>
        <div class="d-md-none p-0 search-bar">
          <div class="dropdown">
            <a class="d-lg-none" title="Search" data-toggle="dropdown" aria-expanded="false" >
              <i class="fas fa-search text-light"></i>
            </a>
            <div class="dropdown-menu dropdown-menu-lg-start col-12">
              {% include 'includes/search-box.html' %}
            </div>
          </div>
        </div>
      </nav>
       <!-- Messages -->
       {% if messages %}
       <div class="message-container">
           {% for message in messages %}
               {% with message.level as level %}
                   {% if level == 40 %}
                       {% include 'includes/toasts/toast_error.html' %}
                   {% elif level == 30 %}
                       {% include 'includes/toasts/toast_warning.html' %}
                   {% elif level == 25 %}
                     {% if 'bag' in message.tags %} 
                       {% include 'includes/toasts/toast_bag_success.html' %}
                   {% else %}
                     {% include 'includes/toasts/toast_success.html' %}
                   {% endif %}
                   {% else %}
                       {% include 'includes/toasts/toast_info.html' %}
                   {% endif %}
               {% endwith %}
           {% endfor %}
       </div>
   {% endif %}
    </header>
     <!-- LOGOUT MODAL -->
     <div class="modal fade" id="logoutModal" tabindex="-1" role="dialog" aria-labelledby="logoutModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header d-flex align-items-center">
            <h5 class="modal-title" id="logoutModalLabel">Logout</h5>
            <button type="button" class="modal-close text-white" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <p>Are you sure you want to sign out?</p> 
          </div>
          <div class="modal-footer">
            <form method="post" action="{% url 'account_logout' %}">
              {% csrf_token %}
              {% if redirect_field_value %}
              <input type="hidden" name="{{ redirect_field_name }}" value="{{ redirect_field_value }}"/>
              {% endif %}
              <button type="submit" class="button btn-secondary small-btn rounded-0">Yes</button>
              <button type="button" class="button btn-secondary small-btn rounded-0" data-dismiss="modal">No</button>
            </form>
          </div>
        </div>
      </div>
    </div>
    <!-- Add new product modal -->
    <div class="modal fade" id="addProductModal" tabindex="-1" role="dialog" aria-labelledby="addProductModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header d-flex align-items-center">
            <h5 class="modal-title" id="addProductModalLabel">Add a new product</h5>
            <button type="button" class="modal-close text-white" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <form method="POST" action="{% url 'product_add' %}" enctype="multipart/form-data">
              {% csrf_token %}
              {% for field in add_product_form %}
              <div class="w-100 mb-3">
                {% if field.name == 'ADD-image' %}
                <label class="w-100">
                  <span hidden>{{field.name}}</span>
                  {{ field }}
                </label>
                {% elif field.name == 'image' %}
                  {{ field }}
                {% else %}
                  <label class="w-100">
                    <span hidden>{{field.name}}</span>
                    {{ field }}
                  </label>
                {% endif %}
                <small class="errorlist"></small>
              </div> 
              {% endfor %}
              <button type="submit" class="btn btn-secondary">Add</button>
            </form>
          </div>
        </div>
      </div>
    </div>
    {% block page_header %} 
    {% endblock %}   
    <main class="flex-shrink-0 main-bg">
      <div class="content-container min-vh">
        {% if request.user.is_authenticated %}
        <p hidden id="authStatus">authenticated</p>
      {% else %}
        <p hidden id="authStatus">neauthenticated</p>
      {% endif %}
      {% if request.user.is_superuser %}
        <p hidden id="userType">admin</p>
      {% else %}
        <p hidden id="userType">client</p>
      {% endif %}
      {{ products_json|json_script:"products_data" }}
      {% block content %} 
      {% endblock %}
      </div>
    </main>
     <!-- Footer -->
     <footer class="footer pt-md-4 pb-4">
      <div class="col-12 col-xl-11 mx-auto">
              <div class="d-md-flex flex-row-reverse text-white">
          <div class="col-12 pb-4 pb-md-0 col-md-6 text-center">
            <div class="col-md-10 pt-4 p-md-0 mx-auto">
              <h4 class="mb-4">Subscribe To Our Newsletter</h4>
              <form method="POST" action="{% url 'subscribe_to_newsletter'%}" id="newsletter">
                {% csrf_token %}
                {{ add_subscriber_form.as_p }}
                <div class="messages mb-2"> 
                  {% if messages %}
                    {% for message in messages %}
                      {% if message.tags == 'form_errors error' %} 
                        {{message}}
                      {% elif message.tags == 'form_success success' %}
                        <div class="success-message">
                          {{message}}
                        </div>
                      {% endif %}
                    {% endfor %}
                  {% endif %}
                </div>
                <button type="submit" class="button small-btn gray-btn rounded-0" name="newsletter_submit_btn" value="{{request.path}}">Subscribe</button> 
              </form>
            </div>
          </div>
          <div class="col-10 pt-4 pt-md-0 col-md-6 mx-auto">
            <div class="d-lg-flex justify-content-between col-md-10 p-0 mx-auto">
              <div class="d-flex flex-column mb-3 mb-lg-0 text-center">
                <a class="text-white" href="{% url 'products' %}">All Products</a>
                <a class="text-white" href="#">Sitemap</a>
                <a class="text-white" href="#">Privacy And Policy</a>
                <a class="text-white" href="#">Terms & Conditions</a>
              </div>
              <div class="text-center">
                <p class="mb-0">Follow us on social media: </p>
                <div class="d-flex justify-content-between text-center mb-2">
                    <a href="https://www.facebook.com" target="_blank" rel="noopener" aria-label="Link to facebook page"><i class="fab fa-facebook-square ms-3 "></i></a>
                    <a href="https://www.twitter.com" target="_blank" rel="noopener" aria-label="Link to twitter page"><i class="fab fa-twitter-square ms-3"></i></a>
                    <a href="https://www.instagram.com" target="_blank" rel="noopener" aria-label="Link to instagram page"><i class="fab fa-instagram-square ms-3"></i></a>
                    <a href="https://www.youtube.com" target="_blank" rel="noopener" aria-label="Link to youtube page"><i class="fab fa-youtube-square ms-3"></i></a>
                </div>
                <p class="mb-0">Copyright &copy;2023 Ayla McCarthy </p>
              </div>
            </div>
          </div>
          <div class="col-12 col-md-6 text-center">
            <div class="col-md-10 p-0 mx-auto">
            </div>
          </div>
        </div>
      </div>
    </footer>

{% block corejs %}
    <script src="https://kit.fontawesome.com/7141b35c3c.js" crossorigin="anonymous"></script> 
    <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
    <script src="{% static 'js/script.js' %}"></script>
    <!-- STRIPE -->
    <script src="https://js.stripe.com/v3/"></script>
{% endblock %}

{% block extra_js %}
{% endblock %}
    
  </body>
</html>